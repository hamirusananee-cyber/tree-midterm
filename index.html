<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>โปรแกรมสร้างแผนภาพ Binary Search Tree</title>
    <style>
        body { font-family: 'Kanit', sans-serif; background-color: #f4f7f1; display: flex; flex-direction: column; align-items: center; padding: 20px; }
        .controls { background: white; padding: 20px; border-radius: 10px; box-shadow: 0 4px 6px rgba(0,0,0,0.1); margin-bottom: 20px; display: flex; gap: 10px; }
        input { padding: 10px; border: 1px solid #ccc; border-radius: 5px; width: 150px; }
        button { padding: 10px 20px; border: none; border-radius: 5px; cursor: pointer; color: white; font-weight: bold; }
        .btn-insert { background-color: #2e7d32; }
        .btn-reset { background-color: #d32f2f; }
        
        #tree-container { background: white; width: 100%; max-width: 800px; height: 400px; border-radius: 10px; position: relative; border: 1px solid #ddd; overflow: auto; }
        .node { width: 40px; height: 40px; background-color: #a5d6a7; border: 2px solid #2e7d32; border-radius: 50%; display: flex; justify-content: center; align-items: center; position: absolute; font-weight: bold; z-index: 2; transition: all 0.5s; }
        .line { position: absolute; background-color: #2e7d32; height: 2px; transform-origin: top left; z-index: 1; }

        .traversal-box { display: flex; gap: 20px; margin-top: 20px; width: 100%; max-width: 800px; }
        .t-card { flex: 1; padding: 15px; border-radius: 10px; text-align: center; box-shadow: 0 2px 4px rgba(0,0,0,0.05); }
        .preorder { background-color: #e8f5e9; border: 1px solid #c8e6c9; }
        .inorder { background-color: #f1f8e9; border: 1px solid #dcedc8; }
        .postorder { background-color: #fce4ec; border: 1px solid #f8bbd0; }
        h4 { margin-top: 0; color: #333; }
        p { word-wrap: break-word; font-size: 14px; }
    </style>
</head>
<body>

    <h2>โปรแกรมสร้างแผนภาพ Binary Search Tree</h2>

    <div class="controls">
        <input type="number" id="node-value" placeholder="ใส่ตัวเลข (เช่น 50)">
        <button class="btn-insert" onclick="insertNode()">+ เพิ่มข้อมูล (Insert)</button>
        <button class="btn-reset" onclick="resetTree()">ล้างข้อมูล (Reset)</button>
    </div>

    <div id="tree-container"></div>

    <div class="traversal-box">
        <div class="t-card preorder">
            <h4>Preorder</h4>
            <p id="preorder-result">-</p>
            <small>(Root → Left → Right)</small>
        </div>
        <div class="t-card inorder">
            <h4>Inorder</h4>
            <p id="inorder-result">-</p>
            <small>(Left → Root → Right)</small>
        </div>
        <div class="t-card postorder">
            <h4>Postorder</h4>
            <p id="postorder-result">-</p>
            <small>(Left → Right → Root)</small>
        </div>
    </div>

    <script>
        class Node {
            constructor(val) {
                this.val = val;
                this.left = null;
                this.right = null;
                this.x = 0; this.y = 0;
            }
        }

        let root = null;
        const container = document.getElementById('tree-container');

        function insertNode() {
            const val = parseInt(document.getElementById('node-value').value);
            if (isNaN(val)) return;
            root = addNode(root, val);
            document.getElementById('node-value').value = '';
            drawTree();
            updateTraversals();
        }

        function addNode(node, val) {
            if (!node) return new Node(val);
            if (val < node.val) node.left = addNode(node.left, val);
            else if (val > node.val) node.right = addNode(node.right, val);
            return node;
        }

        function drawTree() {
            container.innerHTML = '';
            if (!root) return;
            calculatePositions(root, container.offsetWidth / 2, 40, container.offsetWidth / 4);
            renderTree(root);
        }

        function calculatePositions(node, x, y, spacing) {
            if (!node) return;
            node.x = x;
            node.y = y;
            if (node.left) calculatePositions(node.left, x - spacing, y + 80, spacing / 2);
            if (node.right) calculatePositions(node.right, x + spacing, y + 80, spacing / 2);
        }

        function renderTree(node) {
            if (!node) return;
            if (node.left) drawLine(node.x, node.y, node.left.x, node.left.y);
            if (node.right) drawLine(node.x, node.y, node.right.x, node.right.y);

            const div = document.createElement('div');
            div.className = 'node';
            div.innerText = node.val;
            div.style.left = (node.x - 20) + 'px';
            div.style.top = (node.y - 20) + 'px';
            container.appendChild(div);

            renderTree(node.left);
            renderTree(node.right);
        }

        function drawLine(x1, y1, x2, y2) {
            const length = Math.sqrt((x2-x1)**2 + (y2-y1)**2);
            const angle = Math.atan2(y2-y1, x2-x1) * 180 / Math.PI;
            const line = document.createElement('div');
            line.className = 'line';
            line.style.width = length + 'px';
            line.style.left = x1 + 'px';
            line.style.top = y1 + 'px';
            line.style.transform = `rotate(${angle}deg)`;
            container.appendChild(line);
        }

        function updateTraversals() {
            let pre = [], ino = [], post = [];
            function traverse(n) {
                if (!n) return;
                pre.push(n.val);
                traverse(n.left);
                ino.push(n.val);
                traverse(n.right);
                post.push(n.val);
            }
            traverse(root);
            document.getElementById('preorder-result').innerText = pre.join(' → ');
            document.getElementById('inorder-result').innerText = ino.join(' → ');
            document.getElementById('postorder-result').innerText = post.join(' → ');
        }

        function resetTree() {
            root = null;
            container.innerHTML = '';
            document.getElementById('preorder-result').innerText = '-';
            document.getElementById('inorder-result').innerText = '-';
            document.getElementById('postorder-result').innerText = '-';
        }
    </script>
</body>
</html>
