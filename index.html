<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <title>Binary Search Tree Visualization</title>
    <style>
        body { font-family: 'Kanit', sans-serif; background-color: #f0f2f5; display: flex; flex-direction: column; align-items: center; padding: 20px; }
        .card { background: white; padding: 25px; border-radius: 15px; box-shadow: 0 8px 24px rgba(0,0,0,0.1); width: 100%; max-width: 900px; text-align: center; }
        h1 { color: #2e7d32; margin-bottom: 20px; }
        .input-group { margin-bottom: 20px; display: flex; justify-content: center; gap: 10px; }
        input { padding: 12px; border: 2px solid #ddd; border-radius: 8px; width: 120px; outline: none; }
        button { padding: 12px 20px; border: none; border-radius: 8px; cursor: pointer; font-weight: bold; transition: 0.3s; }
        .btn-add { background: #4caf50; color: white; }
        .btn-add:hover { background: #43a047; }
        .btn-reset { background: #ff5252; color: white; }
        
        #canvas-container { position: relative; width: 100%; height: 450px; background: #fafafa; border: 1px solid #eee; border-radius: 10px; overflow: hidden; margin-top: 10px; }
        .node { width: 45px; height: 45px; background: #c8e6c9; border: 3px solid #2e7d32; border-radius: 50%; display: flex; align-items: center; justify-content: center; position: absolute; font-weight: bold; z-index: 10; transition: all 0.5s cubic-bezier(0.175, 0.885, 0.32, 1.275); }
        svg { position: absolute; top: 0; left: 0; width: 100%; height: 100%; }
        line { stroke: #2e7d32; stroke-width: 3; }

        .info-panel { display: grid; grid-template-columns: repeat(3, 1fr); gap: 15px; margin-top: 25px; }
        .info-card { padding: 15px; border-radius: 10px; font-size: 0.9em; }
        .pre { background: #e8f5e9; border: 1px solid #c8e6c9; }
        .in { background: #fff3e0; border: 1px solid #ffe0b2; }
        .post { background: #fce4ec; border: 1px solid #f8bbd0; }
        strong { display: block; margin-bottom: 5px; color: #333; }
    </style>
</head>
<body>

<div class="card">
    <h1>Binary Search Tree (BST)</h1>
    
    <div class="input-group">
        <input type="number" id="valInput" placeholder="ใส่ตัวเลข">
        <button class="btn-add" onclick="insertNode()">+ เพิ่มข้อมูล</button>
        <button class="btn-reset" onclick="resetTree()">ล้างข้อมูล</button>
    </div>

    <div id="canvas-container">
        <svg id="svg-lines"></svg>
    </div>

    <div class="info-panel">
        <div class="info-card pre"><strong>Preorder:</strong> <span id="pre-res">-</span></div>
        <div class="info-card in"><strong>Inorder:</strong> <span id="in-res">-</span></div>
        <div class="info-card post"><strong>Postorder:</strong> <span id="post-res">-</span></div>
    </div>
</div>

<script>
    class Node {
        constructor(v) { this.v = v; this.left = null; this.right = null; this.x = 0; this.y = 0; }
    }
    let root = null;
    const container = document.getElementById('canvas-container');
    const svg = document.getElementById('svg-lines');

    function insertNode() {
        const input = document.getElementById('valInput');
        const v = parseInt(input.value);
        if (isNaN(v)) return;
        root = add(root, v);
        input.value = '';
        draw();
    }

    function add(n, v) {
        if (!n) return new Node(v);
        if (v < n.v) n.left = add(n.left, v);
        else if (v > n.v) n.right = add(n.right, v);
        return n;
    }

    function draw() {
        container.innerHTML = '<svg id="svg-lines"></svg>';
        const newSvg = document.getElementById('svg-lines');
        if (!root) return;
        updatePos(root, container.offsetWidth / 2, 50, container.offsetWidth / 4);
        render(root, newSvg);
        updateText();
    }

    function updatePos(n, x, y, space) {
        if (!n) return;
        n.x = x; n.y = y;
        if (n.left) updatePos(n.left, x - space, y + 80, space / 1.8);
        if (n.right) updatePos(n.right, x + space, y + 80, space / 1.8);
    }

    function render(n, s) {
        if (!n) return;
        if (n.left) drawLine(n.x, n.y, n.left.x, n.left.y, s);
        if (n.right) drawLine(n.x, n.y, n.right.x, n.right.y, s);
        const div = document.createElement('div');
        div.className = 'node'; div.innerText = n.v;
        div.style.left = (n.x - 22) + 'px'; div.style.top = (n.y - 22) + 'px';
        container.appendChild(div);
        render(n.left, s); render(n.right, s);
    }

    function drawLine(x1, y1, x2, y2, s) {
        const l = document.createElementNS("http://www.w3.org/2000/svg", "line");
        l.setAttribute("x1", x1); l.setAttribute("y1", y1);
        l.setAttribute("x2", x2); l.setAttribute("y2", y2);
        s.appendChild(l);
    }

    function updateText() {
        let pre = [], ino = [], pos = [];
        function walk(n) {
            if(!n) return;
            pre.push(n.v); walk(n.left);
            ino.push(n.v); walk(n.right);
            pos.push(n.v);
        }
        walk(root);
        document.getElementById('pre-res').innerText = pre.join(', ');
        document.getElementById('in-res').innerText = ino.join(', ');
        document.getElementById('post-res').innerText = pos.join(', ');
    }

    function resetTree() { root = null; draw(); }
</script>
</body>
</html>
